# ---------------- You should not have to change anything below this line ---
COMP_ROOT=/
COMP_ROOT_G=/G
TOOLSPATH=${COMP_ROOT}/usr/bin
AR=/usr/bin/ar
NLD=/usr/bin/nld
# NLD=${TOOLSPATH}/nld
STRIP=${TOOLSPATH}/strip
# SQLCFE=${COMP_ROOT}/lib/sqlcfe
SQLCFE=/usr/lib/sqlcfe
SQLCOMP=/G/system/system/sqlcomp 
# SQLCOMP=${COMP_ROOT_G}/sqlcomp 
CC=COMP_ROOT=${COMP_ROOT} SQLCFE=${SQLCFE} SQLCOMP=${SQLCOMP} ${TOOLSPATH}/c89 -Wv

C89OPTLEVEL=0
SYMBOLS=-g
FTEST=-D_TANDEM_SOURCE -D_XOPEN_SOURCE
WARN=-Wnowarn=770,262
CFLAGSGUARD=${SYMBOLS} -Wsystype=guardian -Wnostdinc \
-I${COMP_ROOT}/usr/include -Wansistreams -Wnolink -Wnosuppress \
-Wextensions -Woptimize=${C89OPTLEVEL} ${FTEST} ${WARN}

CFLAGS=${CFLAGSGUARD} -Werrors=10
#----------------------------------------------------------------------------#

OBJS=vproc.o preque.o init.o send.o util.o \
     www.o cgi.o cgilib.o \
     mod.o standa.o rfc931.o chkaut.o \
     unig.o unisp.o swn.o \
     initia.o termin.o 

FILES=mod.c cgilib.c rfc931.c send.c standa.c cgi.c chkaut.c init.c util.c www.c swn.c initia.c termin.c unig.c unisp.c vproc.c preque.c 

ALL=OPT/libcgi.a 

#----------------------------------------------------------------------------#

.SUFFIXES: .c .o

comp:
	${CC} ${CFLAGS} ${FILES} 
	echo $(.SOURCE) $(.TARGET)
	${AR} -c libcgia \
         ${OBJS}
	rm *.o
	rm *.L

forceall:
	touch *.[ch]
	make

install:
	touch *.[ch]
	make  C89OPTLEVEL=0 SYMBOLS=-s
	make  installit

installit:
	cp cgilib.h ../demo
	cp libcgi.a ../demo

#----------------------------------------------------------------------------#


#---------------------------------------------------------------------------#

depend:
	grep '^#[       ]*include[      ]*"' *.[c] | \
	sed -e 's/:[^"]*"\([^"]*\)"/:   \1/' -e 's/\.c/.o/' | \
	awk ' { if ($$1 != prev) { print rec; rec = $$0; prev = $$1; } \
	        else { if (length(rec $$2) > 78) { print rec; rec = $$0; } \
	               else rec = rec " " $$2 } } \
	      END { print rec } ' > makedep
	echo '/^# DO NOT DELETE THIS LINE/+2,$$d' >eddep
	echo '$$r makedep' >>eddep
	echo 'w' >>eddep
	cp makefile makefile.bak
	ed - makefile < eddep
	rm eddep makedep
	echo '' >> makefile
	echo '# DEPENDENCIES MUST END AT END OF FILE' >> makefile
	echo '# IF YOU PUT STUFF HERE IT WILL GO AWAY' >> makefile
	echo '# see make depend above' >> makefile
	tail -n 20 makefile 

# DO NOT DELETE THIS LINE -- make depend uses it

cgio:   config.h wn.h version.h cgi.h cgilib.h
cgilibo:   wn.h version.h cgi.h cgilib.h
chkauto:   config.h wn.h auth.h
inito:   config.h wn.h version.h err.h content.h cgilib.h
modo:   config.h wn.h
prequeo:   config.h uniguard.h wn.h
rfc931o:   config.h wn.h
sendo:   config.h cgilib.h wn.h version.h
standao:   config.h unispawn.h uniguard.h wn.h
swno:   config.h uniguard.h wn.h version.h cgi.h
uniguao:   uniguard.h
unispao:   wn.h unispawn.h
utilo:   config.h wn.h
wwwo:   config.h wn.h
vproco:  
aborto:
termino:
initiao:
# DEPENDENCIES MUST END AT END OF FILE
# IF YOU PUT STUFF HERE IT WILL GO AWAY
# see make depend above
